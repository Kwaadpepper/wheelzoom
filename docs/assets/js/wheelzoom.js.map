{"version":3,"sources":["__header.coffee","init.js","__modules.coffee","fullscreenHandler.coffee","wheelzoom.coffee","classes/Events.coffee","classes/Image.coffee","classes/ImageApi.coffee","classes/Wheelzoom.coffee","windowGlobals/customEvent.coffee","windowGlobals/triggerEvent.coffee","init.coffee"],"names":["Events","Image","ImageApi","Wheelzoom","__whmodules","globals","modules","add","_module","push","bind","addClass","_className","_class","windowRegister","_globalElement","init","i","len","ref","results","length","call","fullscreenchangeHandler","window","wheelzoom","resetAll","document","addEventListener","staticMethods","defaults","zoom","pinchSensibility","maxZoom","isPinched","elements","options","staticMethod","whz","_whzImage","initEvents","on","off","trigger","onwheel","drag","draggable","removeDrag","destroy","previousEvent","whzImage","domImage","imgInfo","_events","reset","forEach","evt","element","removeEventListener","eventName","zoomTimer","triggerEvent","x","bgPosX","initBgPosX","y","bgPosY","initBgPosY","clearTimeout","setTimeout","e","deltaY","preventDefault","wheelDelta","deltaPinch","dist","prevDist","xShift","yShift","type","touches","pageX","pageY","Math","sqrt","pow","updateBgStyle","_domImage","_options","t","isEqualTo","load","setSrcToBackground","canvas","createElement","wzEvents","wzImageApi","setInterval","img","complete","clearInterval","computedStyle","height","width","src","cachedDataUrl","getComputedStyle","parseInt","bgWidth","bgHeight","style","backgroundSize","backgroundPosition","imageBox","windowBox","left","right","top","down","backgroundImage","backgroundRepeat","naturalWidth","naturalHeight","toDataURL","propagate","bgCenterX","bgCenterY","bgRatioX","bgRatioY","offsetX","offsetY","zoomSensibility","getAttribute","registerApiMethods","doZoomIn","doZoomOut","doDrag","wz","addImage","parseOptions","wheelzoomSingleton","wzImgs","nodeName","wzImg","splice","out","Object","keys","key","CustomEvent","event","params","bubbles","cancelable","detail","createEvent","initCustomEvent","prototype","Event","target","err","error","dispatchEvent"],"mappings":"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","file":"wheelzoom.js","sourcesContent":["##! Wheelzoom 1.3.0\n#  license: MIT\n#  https://kwaadpepper.github.io/wheelzoom/\n#\n","//#! Wheelzoom 1.3.0\n//  license: MIT\n//  https://kwaadpepper.github.io/wheelzoom/\n\nvar Events, Image, ImageApi, Wheelzoom, __whmodules;\n\n__whmodules = {\n  globals: {},\n  modules: [],\n  add: function(_module) {\n    return __whmodules.modules.push(_module.bind(__whmodules.globals));\n  },\n  addClass: function(_className, _class) {\n    return __whmodules.globals[_className] = _class.bind(__whmodules.globals);\n  },\n  windowRegister: function(_globalElement) {\n    return _globalElement();\n  },\n  init: function() {\n    var _module, i, len, ref, results;\n    ref = __whmodules.modules;\n    results = [];\n    for (i = 0, len = ref.length; i < len; i++) {\n      _module = ref[i];\n      results.push(_module.call(__whmodules.globals));\n    }\n    return results;\n  }\n};\n\n__whmodules.add(function() {\n  var fullscreenchangeHandler;\n  fullscreenchangeHandler = function() {\n    return window.wheelzoom.resetAll();\n  };\n  if (document.addEventListener) {\n    document.addEventListener('fullscreenchange', fullscreenchangeHandler, false);\n    document.addEventListener('mozfullscreenchange', fullscreenchangeHandler, false);\n    document.addEventListener('MSFullscreenChange', fullscreenchangeHandler, false);\n    return document.addEventListener('webkitfullscreenchange', fullscreenchangeHandler, false);\n  }\n});\n\n__whmodules.add(function() {\n  var staticMethods;\n  this.defaults = {\n    zoom: 0.10,\n    pinchSensibility: 0.3,\n    maxZoom: -1\n  };\n  this.isPinched = false;\n  staticMethods = ['images', 'resetAll', 'destroyAll'];\n  return window.wheelzoom = function(elements, options) {\n    var i, len, staticMethod, whz;\n    whz = new Wheelzoom(elements, options);\n    for (i = 0, len = staticMethods.length; i < len; i++) {\n      staticMethod = staticMethods[i];\n      window.wheelzoom[staticMethod] = Wheelzoom[staticMethod];\n    }\n    return whz;\n  };\n});\n\n__whmodules.addClass('Events', Events = class Events {\n  constructor(_whzImage) {\n    this.initEvents = this.initEvents.bind(this);\n    this.on = this.on.bind(this);\n    this.off = this.off.bind(this);\n    this.trigger = this.trigger.bind(this);\n    this.onwheel = this.onwheel.bind(this);\n    this.drag = this.drag.bind(this);\n    this.draggable = this.draggable.bind(this);\n    this.removeDrag = this.removeDrag.bind(this);\n    this.destroy = this.destroy.bind(this);\n    // Instance variables\n    this.previousEvent = null;\n    this.whzImage = _whzImage;\n    this.domImage = _whzImage.domImage;\n    this.imgInfo = _whzImage.imgInfo;\n    this._events = {};\n    // Init\n    this.initEvents();\n  }\n\n  initEvents() {\n    this._events['wheelzoom.reset'] = (() => {\n      return this.whzImage.reset();\n    }).bind(this);\n    this._events['wheelzoom.destroy'] = this.destroy.bind(this);\n    this._events['wheel'] = this.onwheel.bind(this);\n    this._events['mousedown'] = this.draggable.bind(this);\n    this._events['touchstart'] = this.draggable.bind(this);\n    this._events['touchmove'] = this.drag.bind(this);\n    this._events['touchend'] = this.removeDrag.bind(this);\n    this._events['mousemove'] = this.drag.bind(this);\n    this._events['mouseup'] = this.removeDrag.bind(this);\n    return ['wheelzoom.reset', 'wheelzoom.destroy', 'wheel', 'mousedown', 'touchstart'].forEach(((evt) => {\n      return this.on(this.domImage, evt);\n    }).bind(this));\n  }\n\n  on(element, evt) {\n    return element.addEventListener(evt, this._events[evt]);\n  }\n\n  off(element, evt) {\n    return element.removeEventListener(evt, this._events[evt]);\n  }\n\n  trigger(eventName, options) {\n    var zoomTimer;\n    zoomTimer = null;\n    options = options || {};\n    switch (eventName) {\n      case 'wheelzoom.dragend':\n        window.triggerEvent(this.domImage, eventName, {\n          x: this.imgInfo.bgPosX - this.imgInfo.initBgPosX,\n          y: this.imgInfo.bgPosY - this.imgInfo.initBgPosY\n        });\n        break;\n      case 'wheelzoom.dragstart':\n      case 'wheelzoom.reset':\n      case 'wheelzoom.drag':\n        window.triggerEvent(this.domImage, eventName, options);\n        break;\n      case 'wheelzoom.out':\n      case 'wheelzoom.in':\n        // setTimeout to handle lot of events fired\n        clearTimeout(zoomTimer);\n        zoomTimer = setTimeout(((eventName, options) => {\n          return window.triggerEvent(this.domImage, eventName, options);\n        }).bind(this, eventName, options), 10);\n        break;\n    }\n  }\n\n  onwheel(e) {\n    var deltaY;\n    e.preventDefault();\n    deltaY = 0;\n    // FireFox 17+ (IE9+, Chrome 31+?)\n    if (e.deltaY) {\n      deltaY = e.deltaY;\n    } else if (e.wheelDelta) {\n      deltaY = -e.wheelDelta;\n    }\n    return this.whzImage.zoom(deltaY, true);\n  }\n\n  drag(e) {\n    var deltaPinch, dist, prevDist, x, xShift, y, yShift;\n    e.preventDefault();\n    switch (e.type) {\n      case 'touchstart':\n      case 'touchmove':\n        __whmodules.globals['isPinched'] = e.touches.length === 2;\n        xShift = e.touches[0].pageX;\n        yShift = e.touches[0].pageY;\n        break;\n      default:\n        xShift = e.pageX;\n        yShift = e.pageY;\n    }\n    switch (this.previousEvent.type) {\n      case 'touchstart':\n      case 'touchmove':\n        __whmodules.globals['isPinched'] = this.previousEvent.touches.length === 2;\n        xShift -= this.previousEvent.touches[0].pageX;\n        yShift -= this.previousEvent.touches[0].pageY;\n        break;\n      default:\n        xShift -= this.previousEvent.pageX;\n        yShift -= this.previousEvent.pageY;\n    }\n    if (__whmodules.globals['isPinched']) {\n      dist = Math.sqrt(Math.pow(e.touches[1].pageX - e.touches[0].pageX, 2) + Math.pow(e.touches[1].pageY - e.touches[0].pageY, 2));\n      prevDist = Math.sqrt(Math.pow(this.previousEvent.touches[1].pageX - this.previousEvent.touches[0].pageX, 2) + Math.pow(this.previousEvent.touches[1].pageY - this.previousEvent.touches[0].pageY, 2));\n      deltaPinch = prevDist - dist;\n      this.whzImage.zoom(deltaPinch, true);\n      return;\n    }\n    x = this.imgInfo.bgPosX + xShift;\n    y = this.imgInfo.bgPosY + yShift;\n    this.whzImage.drag(x, y);\n    this.trigger('wheelzoom.drag', {\n      bgPosX: this.imgInfo.bgPosX,\n      bgPosY: this.imgInfo.bgPosY,\n      xShift: xShift,\n      yShift: yShift\n    });\n    this.previousEvent = e;\n    return this.whzImage.updateBgStyle();\n  }\n\n  draggable(e) {\n    e.preventDefault();\n    this.trigger('wheelzoom.dragend');\n    this.previousEvent = e;\n    if (e.type === 'touchstart') {\n      this.on(document, 'touchmove');\n      return this.on(document, 'touchend');\n    } else {\n      this.on(document, 'mousemove');\n      return this.on(document, 'mouseup');\n    }\n  }\n\n  removeDrag(e) {\n    e.preventDefault();\n    this.trigger('wheelzoom.dragend');\n    this.off(document, 'touchmove');\n    this.off(document, 'touchend');\n    this.off(document, 'mousemove');\n    return this.off(document, 'mouseup');\n  }\n\n  destroy(e) {\n    this.whzImage.destroy();\n    this.off(this.domImage, 'wheelzoom.reset');\n    this.off(this.domImage, 'wheelzoom.destroy');\n    this.off(this.domImage, 'wheel');\n    this.off(this.domImage, 'mousedown');\n    this.off(this.domImage, 'mouseup');\n    this.off(this.domImage, 'mousemove');\n    this.off(this.domImage, 'touchstart');\n    this.off(this.domImage, 'touchleave');\n    this.off(this.domImage, 'touchmove');\n    delete this.previousEvent;\n    delete this.whzImage;\n    delete this.domImage;\n    delete this.imgInfo;\n    return delete this._events;\n  }\n\n});\n\n__whmodules.addClass('Image', Image = class Image {\n  constructor(_domImage, _options) {\n    var t;\n    this.isEqualTo = this.isEqualTo.bind(this);\n    this.load = this.load.bind(this);\n    this.updateBgStyle = this.updateBgStyle.bind(this);\n    this.reset = this.reset.bind(this);\n    this.setSrcToBackground = this.setSrcToBackground.bind(this);\n    this.zoom = this.zoom.bind(this);\n    this.drag = this.drag.bind(this);\n    this.destroy = this.destroy.bind(this);\n    // Instance variables\n    this.domImage = _domImage;\n    this.canvas = document.createElement('canvas');\n    this.options = _options || {};\n    this.imgInfo = {};\n    this.wzEvents = new Events(this);\n    this.wzImageApi = new ImageApi(this);\n    t = setInterval((function(img, load) {\n      if (img.complete) {\n        load();\n        return clearInterval(t);\n      }\n    }).bind(null, this.domImage, this.load.bind(this)), 100);\n  }\n\n  isEqualTo(img) {\n    return img === this.domImage;\n  }\n\n  load() {\n    var bgPosX, bgPosY, computedStyle, height, width;\n    if (this.domImage.src === this.imgInfo.cachedDataUrl) {\n      return;\n    }\n    computedStyle = window.getComputedStyle(this.domImage, null);\n    width = parseInt(computedStyle.width, 10);\n    height = parseInt(computedStyle.height, 10);\n    bgPosX = (this.domImage.width - width) / 2;\n    bgPosY = (this.domImage.height - height) / 2;\n    this.imgInfo.width = width;\n    this.imgInfo.height = height;\n    this.imgInfo.bgWidth = width;\n    this.imgInfo.bgHeight = height;\n    this.imgInfo.initBgPosX = bgPosX;\n    this.imgInfo.initBgPosY = bgPosY;\n    this.imgInfo.bgPosX = bgPosX;\n    this.imgInfo.bgPosY = bgPosY;\n    this.setSrcToBackground(this.domImage);\n    this.domImage.style.backgroundSize = this.imgInfo.width + 'px ' + this.imgInfo.height + 'px';\n    return this.domImage.style.backgroundPosition = this.imgInfo.bgPosX + 'px ' + this.imgInfo.bgPosY + 'px';\n  }\n\n  updateBgStyle() {\n    var imageBox, windowBox;\n    windowBox = {\n      left: 0,\n      right: this.domImage.width,\n      top: 0,\n      down: this.domImage.height,\n      width: this.domImage.width,\n      height: this.domImage.height\n    };\n    imageBox = {\n      left: this.imgInfo.bgPosX,\n      right: this.imgInfo.bgPosX + this.imgInfo.bgWidth,\n      top: this.imgInfo.bgPosY,\n      down: this.imgInfo.bgPosY + this.imgInfo.bgHeight,\n      width: this.imgInfo.bgWidth,\n      height: this.imgInfo.bgHeight\n    };\n    // If image width is smaller than canvas width\n    if (imageBox.width < windowBox.width) {\n      if (imageBox.left < windowBox.left) {\n        // do not overflow left\n        this.imgInfo.bgPosX = windowBox.left;\n      } else if (imageBox.right > windowBox.right) {\n        // do not overflow right\n        this.imgInfo.bgPosX = windowBox.right - this.imgInfo.bgWidth; // if image width is bigger than canvas width\n      }\n    } else {\n      // force overflow left\n      if (imageBox.left > windowBox.left) {\n        this.imgInfo.bgPosX = windowBox.left;\n      } else if (imageBox.right < windowBox.right) {\n        // force overflow right\n        this.imgInfo.bgPosX = windowBox.right - this.imgInfo.bgWidth;\n      }\n    }\n    // If image height is smaller than canvas height\n    if (imageBox.height < windowBox.height) {\n      if (imageBox.top < windowBox.top) {\n        // do not overflow top\n        this.imgInfo.bgPosY = windowBox.top;\n      } else {\n        if (imageBox.down > windowBox.down) { //endregion do not overflow down\n          this.imgInfo.bgPosY = windowBox.down - this.imgInfo.bgHeight; // if image height is bigger than canvas height\n        }\n      }\n    } else {\n      if (imageBox.top > windowBox.top) { // force overflow top\n        this.imgInfo.bgPosY = windowBox.top;\n      } else if (imageBox.down < windowBox.down) {\n        // force overflow down\n        this.imgInfo.bgPosY = windowBox.down - this.imgInfo.bgHeight;\n      }\n    }\n    this.domImage.style.backgroundSize = `${this.imgInfo.bgWidth}px ${this.imgInfo.bgHeight}px`;\n    return this.domImage.style.backgroundPosition = `${this.imgInfo.bgPosX}px ${this.imgInfo.bgPosY}px`;\n  }\n\n  reset() {\n    this.imgInfo.bgWidth = this.imgInfo.width;\n    this.imgInfo.bgHeight = this.imgInfo.height;\n    this.imgInfo.bgPosX = this.domImage.width / 2 - this.imgInfo.width / 2;\n    this.imgInfo.bgPosY = this.domImage.height / 2 - this.imgInfo.height / 2;\n    return this.updateBgStyle();\n  }\n\n  setSrcToBackground() {\n    this.domImage.style.backgroundImage = `url('${this.domImage.src}')`;\n    this.domImage.style.backgroundRepeat = 'no-repeat';\n    this.canvas.width = this.domImage.naturalWidth;\n    this.canvas.height = this.domImage.naturalHeight;\n    this.imgInfo.cachedDataUrl = this.canvas.toDataURL();\n    return this.domImage.src = this.imgInfo.cachedDataUrl;\n  }\n\n  zoom(deltaY, propagate = false) {\n    var bgCenterX, bgCenterY, bgRatioX, bgRatioY, offsetX, offsetY, zoomSensibility;\n    zoomSensibility = __whmodules.globals['isPinched'] ? this.options.zoom * this.options.pinchSensibility : this.options.zoom;\n    // zoom always at the center of the image\n    offsetX = this.domImage.width / 2;\n    offsetY = this.domImage.height / 2;\n    // Record the offset between the bg edge and the center of the image:\n    bgCenterX = offsetX - this.imgInfo.bgPosX;\n    bgCenterY = offsetY - this.imgInfo.bgPosY;\n    // Use the previous offset to get the percent offset between the bg edge\n    // and the center of the image:\n    bgRatioX = bgCenterX / this.imgInfo.bgWidth;\n    bgRatioY = bgCenterY / this.imgInfo.bgHeight;\n    // Update the bg size:\n    if (deltaY < 0) {\n      if (this.options.maxZoom === -1 || ((this.imgInfo.bgWidth + this.imgInfo.bgWidth * zoomSensibility) / this.imgInfo.width) <= this.options.maxZoom) {\n        this.imgInfo.bgWidth += this.imgInfo.bgWidth * zoomSensibility;\n        this.imgInfo.bgHeight += this.imgInfo.bgHeight * zoomSensibility;\n      }\n    } else {\n      this.imgInfo.bgWidth -= this.imgInfo.bgWidth * zoomSensibility;\n      this.imgInfo.bgHeight -= this.imgInfo.bgHeight * zoomSensibility;\n    }\n    // Take the percent offset and apply it to the new size:\n    this.imgInfo.bgPosX = offsetX - (this.imgInfo.bgWidth * bgRatioX);\n    this.imgInfo.bgPosY = offsetY - (this.imgInfo.bgHeight * bgRatioY);\n    if (propagate) {\n      if (deltaY < 0) {\n        this.wzEvents.trigger('wheelzoom.in', {\n          zoom: this.imgInfo.bgWidth / this.imgInfo.width,\n          bgPosX: this.imgInfo.bgPosX,\n          bgPosY: this.imgInfo.bgPosY\n        });\n      } else {\n        this.wzEvents.trigger('wheelzoom.out', {\n          zoom: this.imgInfo.bgWidth / this.imgInfo.width,\n          bgPosX: this.imgInfo.bgPosX,\n          bgPosY: this.imgInfo.bgPosY\n        });\n      }\n    }\n    // Prevent zooming out beyond the starting size\n    if (this.imgInfo.bgWidth <= this.imgInfo.width || this.imgInfo.bgHeight <= this.imgInfo.height) {\n      return this.wzEvents.trigger('wheelzoom.reset');\n    } else {\n      return this.updateBgStyle();\n    }\n  }\n\n  drag(x, y) {\n    this.imgInfo.bgPosX = x;\n    this.imgInfo.bgPosY = y;\n    return this.updateBgStyle();\n  }\n\n  destroy() {\n    this.domImage.style = this.domImage.getAttribute('style');\n    this.domImage.src = this.domImage.getAttribute('src');\n    this.wzImageApi.destroy();\n    return delete this.wzImageApi;\n  }\n\n});\n\n__whmodules.addClass('ImageApi', ImageApi = class ImageApi {\n  constructor(_whzImage) {\n    this.registerApiMethods = this.registerApiMethods.bind(this);\n    this.destroy = this.destroy.bind(this);\n    this.doZoomIn = this.doZoomIn.bind(this);\n    this.doZoomOut = this.doZoomOut.bind(this);\n    this.doDrag = this.doDrag.bind(this);\n    this.whzImage = _whzImage;\n    this.domImage = _whzImage.domImage;\n    this.registerApiMethods();\n  }\n\n  registerApiMethods() {\n    this.domImage.doZoomIn = this.doZoomIn.bind(this);\n    this.domImage.doZoomOut = this.doZoomOut.bind(this);\n    return this.domImage.doDrag = this.doDrag.bind(this);\n  }\n\n  destroy() {\n    return delete this.domImage.wz;\n  }\n\n  doZoomIn() {\n    return this.whzImage.zoom(-100, false);\n  }\n\n  doZoomOut() {\n    return this.whzImage.zoom(100, false);\n  }\n\n  doDrag(x, y) {\n    return this.whzImage.drag(x, y);\n  }\n\n});\n\n__whmodules.addClass('Wheelzoom', Wheelzoom = (function() {\n  var addImage, globals, parseOptions, wheelzoomSingleton, wzImgs;\n\n  class Wheelzoom {\n    // public methods\n    constructor(elements, options) {\n      this.init(elements, options);\n      if (wheelzoomSingleton === !null) {\n        return wheelzoomSingleton;\n      } else {\n        return wheelzoomSingleton = this;\n      }\n    }\n\n    init(elements, options) {\n      var element, i, len;\n      // Do nothing in IE8\n      if (typeof window.getComputedStyle !== 'function') {\n        return elements;\n      }\n      if (elements && elements.length) {\n        for (i = 0, len = elements.length; i < len; i++) {\n          element = elements[i];\n          addImage(element, options);\n        }\n      } else if (elements && elements.nodeName) {\n        addImage(elements, options);\n      }\n      return elements;\n    }\n\n    // public static methods\n    static images() {\n      return wzImgs;\n    }\n\n    static resetAll() {\n      return wzImgs.forEach(function(wzImg) {\n        return wzImg.reset();\n      });\n    }\n\n    static destroyAll() {\n      var results;\n      results = [];\n      while (wzImgs.length) {\n        wzImgs[0].destroy();\n        results.push(wzImgs.splice(0, 1));\n      }\n      return results;\n    }\n\n  };\n\n  // private static\n  wheelzoomSingleton = null;\n\n  wzImgs = [];\n\n  globals = __whmodules.globals;\n\n  // private methods\n  addImage = function(img, options) {\n    var wzImg;\n    if (!img || !img.nodeName || img.nodeName !== 'IMG') {\n      return;\n    }\n    wzImg = new Image(img, parseOptions(options));\n    return wzImgs.push(wzImg);\n  };\n\n  parseOptions = function(options) {\n    var out;\n    out = {};\n    options = options || {};\n    Object.keys(globals['defaults']).forEach(function(key) {\n      return out[key] = typeof options[key] !== 'undefined' ? options[key] : globals['defaults'][key];\n    });\n    return out;\n  };\n\n  return Wheelzoom;\n\n}).call(this));\n\n__whmodules.windowRegister(function() {\n  var CustomEvent;\n  CustomEvent = function(event, params) {\n    var evt;\n    params = params || {\n      bubbles: false,\n      cancelable: false,\n      detail: void 0\n    };\n    evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  };\n  CustomEvent.prototype = window.Event.prototype;\n  return window.CustomEvent = CustomEvent;\n});\n\n// create cross browser triggerEvent function\n__whmodules.windowRegister(function() {\n  return window.triggerEvent = function(target, eventName, params) {\n    var e, err;\n    if (params) {\n      e = new CustomEvent(eventName, {\n        detail: params\n      });\n    } else {\n      try {\n        e = new Event(eventName);\n      } catch (error) {\n        err = error;\n        e = new CustomEvent(eventName);\n      }\n    }\n    return target.dispatchEvent(e, params);\n  };\n});\n\n(function() {\n  return __whmodules.init();\n})();\n","__whmodules = {\n  globals: {},\n  modules: [],\n  add: (_module) -> __whmodules.modules.push _module.bind __whmodules.globals\n  addClass: (_className, _class) ->\n    __whmodules.globals[_className] = _class.bind __whmodules.globals\n  windowRegister: (_globalElement) -> _globalElement()\n  init: -> _module.call(__whmodules.globals) for _module in __whmodules.modules\n}\n","__whmodules.add ->\n  fullscreenchangeHandler = -> window.wheelzoom.resetAll()\n\n  if document.addEventListener\n    document.addEventListener 'fullscreenchange', fullscreenchangeHandler, false\n    document.addEventListener 'mozfullscreenchange', fullscreenchangeHandler, false\n    document.addEventListener 'MSFullscreenChange', fullscreenchangeHandler, false\n    document.addEventListener 'webkitfullscreenchange', fullscreenchangeHandler, false\n","__whmodules.add ->\n\n  @defaults = {\n    zoom: 0.10,\n    pinchSensibility: 0.3,\n    maxZoom: -1\n  }\n  @isPinched = false\n\n  staticMethods = [\n    'images', 'resetAll', 'destroyAll'\n  ]\n\n  window.wheelzoom = (elements, options) ->\n    whz = new Wheelzoom(elements, options)\n    for staticMethod in staticMethods\n      window.wheelzoom[staticMethod] = Wheelzoom[staticMethod]\n    return whz\n","__whmodules.addClass 'Events',\n\n  class Events\n\n    constructor: (_whzImage) ->\n\n      # Instance variables\n      @previousEvent = null\n      @whzImage = _whzImage\n      @domImage = _whzImage.domImage\n      @imgInfo = _whzImage.imgInfo\n      @_events = {}\n\n      # Init\n      @initEvents()\n\n    initEvents: =>\n      @_events['wheelzoom.reset'] = (=> @whzImage.reset()).bind @\n      @_events['wheelzoom.destroy'] = @destroy.bind @\n      @_events['wheel'] = @onwheel.bind @\n      @_events['mousedown'] = @draggable.bind @\n      @_events['touchstart'] = @draggable.bind @\n      @_events['touchmove'] = @drag.bind @\n      @_events['touchend'] = @removeDrag.bind @\n      @_events['mousemove'] = @drag.bind @\n      @_events['mouseup'] = @removeDrag.bind @\n\n      [ 'wheelzoom.reset',\n        'wheelzoom.destroy',\n        'wheel',\n        'mousedown',\n        'touchstart'\n      ].forEach  ((evt) => @on @domImage, evt).bind @\n\n    on: (element, evt) => element.addEventListener evt, @_events[evt]\n    off: (element, evt) => element.removeEventListener evt, @_events[evt]\n    trigger: (eventName, options) =>\n      zoomTimer = null\n      options = options or {}\n      switch eventName\n        when 'wheelzoom.dragend'\n          window.triggerEvent @domImage, eventName, {\n            x: @imgInfo.bgPosX - @imgInfo.initBgPosX,\n            y: @imgInfo.bgPosY - @imgInfo.initBgPosY\n          }\n          break\n        when 'wheelzoom.dragstart', 'wheelzoom.reset', 'wheelzoom.drag'\n          window.triggerEvent @domImage, eventName, options\n          break\n        when 'wheelzoom.out', 'wheelzoom.in'\n          # setTimeout to handle lot of events fired\n          clearTimeout zoomTimer\n          zoomTimer = setTimeout ((eventName, options) =>\n            window.triggerEvent @domImage, eventName, options\n          ).bind(@, eventName, options), 10\n          break\n\n    onwheel: (e) =>\n      e.preventDefault()\n\n      deltaY = 0\n\n      # FireFox 17+ (IE9+, Chrome 31+?)\n      if e.deltaY then deltaY = e.deltaY\n      else if e.wheelDelta then deltaY = -e.wheelDelta\n\n      @whzImage.zoom deltaY, true\n\n    drag: (e) =>\n      e.preventDefault()\n\n      switch e.type\n        when 'touchstart'\n        , 'touchmove'\n          __whmodules.globals['isPinched'] = e.touches.length == 2\n          xShift = e.touches[0].pageX\n          yShift = e.touches[0].pageY\n          break\n        else\n          xShift = e.pageX\n          yShift = e.pageY\n\n      switch @previousEvent.type\n        when 'touchstart'\n        , 'touchmove'\n          __whmodules.globals['isPinched'] = @previousEvent.touches.length == 2\n          xShift -= @previousEvent.touches[0].pageX\n          yShift -= @previousEvent.touches[0].pageY\n          break\n        else\n          xShift -= @previousEvent.pageX\n          yShift -= @previousEvent.pageY\n\n      if __whmodules.globals['isPinched'] # Zoom if pinch\n        dist = Math.sqrt(\n          Math.pow(e.touches[1].pageX - e.touches[0].pageX, 2) +\n          Math.pow(e.touches[1].pageY - e.touches[0].pageY, 2))\n        prevDist = Math.sqrt(\n          Math.pow(@previousEvent.touches[1].pageX - @previousEvent.touches[0].pageX, 2) +\n          Math.pow(@previousEvent.touches[1].pageY - @previousEvent.touches[0].pageY, 2))\n        deltaPinch = prevDist - dist\n\n        @whzImage.zoom deltaPinch, true\n        return\n\n      x = @imgInfo.bgPosX + xShift\n      y = @imgInfo.bgPosY + yShift\n\n      @whzImage.drag x, y\n\n      @trigger 'wheelzoom.drag', {\n        bgPosX: @imgInfo.bgPosX,\n        bgPosY: @imgInfo.bgPosY,\n        xShift: xShift,\n        yShift: yShift\n      }\n\n      @previousEvent = e\n      @whzImage.updateBgStyle()\n\n    draggable: (e) =>\n      e.preventDefault()\n      @trigger 'wheelzoom.dragend'\n      @previousEvent = e\n      if e.type == 'touchstart'\n        @on document, 'touchmove'\n        @on document, 'touchend'\n      else\n        @on document, 'mousemove'\n        @on document, 'mouseup'\n\n    removeDrag: (e) =>\n      e.preventDefault()\n      @trigger 'wheelzoom.dragend'\n      @off document, 'touchmove'\n      @off document, 'touchend'\n      @off document, 'mousemove'\n      @off document, 'mouseup'\n\n    destroy: (e) =>\n      @whzImage.destroy()\n      @off @domImage, 'wheelzoom.reset'\n      @off @domImage, 'wheelzoom.destroy'\n      @off @domImage, 'wheel'\n      @off @domImage, 'mousedown'\n      @off @domImage, 'mouseup'\n      @off @domImage, 'mousemove'\n      @off @domImage, 'touchstart'\n      @off @domImage, 'touchleave'\n      @off @domImage, 'touchmove'\n\n      delete @previousEvent\n      delete @whzImage\n      delete @domImage\n      delete @imgInfo\n      delete @_events\n","__whmodules.addClass 'Image',\n\n  class Image\n\n    constructor: (_domImage, _options) ->\n\n      # Instance variables\n      @domImage = _domImage\n      @canvas = document.createElement('canvas')\n      @options = _options or {}\n      @imgInfo = {}\n      @wzEvents = new Events(@)\n      @wzImageApi = new ImageApi(@)\n\n      t = setInterval ((img, load) ->\n        if img.complete\n          load()\n          clearInterval(t)\n      ).bind(null, @domImage, @load.bind(@)), 100\n\n    isEqualTo: (img) => img == @domImage\n\n    load: =>\n      if @domImage.src == @imgInfo.cachedDataUrl then return\n\n      computedStyle = window.getComputedStyle(@domImage, null)\n\n      width = parseInt(computedStyle.width, 10)\n      height = parseInt(computedStyle.height, 10)\n      bgPosX = (@domImage.width - width) / 2\n      bgPosY = (@domImage.height - height) / 2\n\n      @imgInfo.width = width\n      @imgInfo.height = height\n      @imgInfo.bgWidth = width\n      @imgInfo.bgHeight = height\n      @imgInfo.initBgPosX = bgPosX\n      @imgInfo.initBgPosY = bgPosY\n      @imgInfo.bgPosX = bgPosX\n      @imgInfo.bgPosY = bgPosY\n\n\n      @setSrcToBackground(@domImage)\n\n      @domImage.style.backgroundSize = @imgInfo.width + 'px ' + @imgInfo.height + 'px'\n      @domImage.style.backgroundPosition = @imgInfo.bgPosX + 'px ' + @imgInfo.bgPosY + 'px'\n\n    updateBgStyle: =>\n      windowBox = {\n        left: 0,\n        right: @domImage.width,\n        top: 0,\n        down: @domImage.height,\n        width: @domImage.width,\n        height: @domImage.height\n      }\n\n      imageBox = {\n        left: @imgInfo.bgPosX,\n        right: @imgInfo.bgPosX + @imgInfo.bgWidth,\n        top: @imgInfo.bgPosY,\n        down: @imgInfo.bgPosY + @imgInfo.bgHeight,\n        width: @imgInfo.bgWidth,\n        height: @imgInfo.bgHeight\n      }\n\n      # If image width is smaller than canvas width\n      if imageBox.width < windowBox.width\n        if imageBox.left < windowBox.left\n          # do not overflow left\n          @imgInfo.bgPosX = windowBox.left\n        else if imageBox.right > windowBox.right\n          # do not overflow right\n          @imgInfo.bgPosX = windowBox.right - @imgInfo.bgWidth\n      else # if image width is bigger than canvas width\n        # force overflow left\n        if imageBox.left > windowBox.left\n          @imgInfo.bgPosX = windowBox.left\n        else if imageBox.right < windowBox.right\n          # force overflow right\n          @imgInfo.bgPosX = windowBox.right - @imgInfo.bgWidth\n\n      # If image height is smaller than canvas height\n      if imageBox.height < windowBox.height\n        if imageBox.top < windowBox.top\n          # do not overflow top\n          @imgInfo.bgPosY = windowBox.top\n        else\n          if imageBox.down > windowBox.down #endregion do not overflow down\n            @imgInfo.bgPosY = windowBox.down - @imgInfo.bgHeight\n      else # if image height is bigger than canvas height\n        if imageBox.top > windowBox.top # force overflow top\n          @imgInfo.bgPosY = windowBox.top\n        else if imageBox.down < windowBox.down\n          # force overflow down\n          @imgInfo.bgPosY = windowBox.down - @imgInfo.bgHeight\n\n      @domImage.style.backgroundSize = \"#{@imgInfo.bgWidth}px #{@imgInfo.bgHeight}px\"\n      @domImage.style.backgroundPosition = \"#{@imgInfo.bgPosX}px #{@imgInfo.bgPosY}px\"\n\n    reset: =>\n      @imgInfo.bgWidth = @imgInfo.width\n      @imgInfo.bgHeight = @imgInfo.height\n      @imgInfo.bgPosX = @domImage.width / 2 - @imgInfo.width / 2\n      @imgInfo.bgPosY = @domImage.height / 2 - @imgInfo.height / 2\n      @updateBgStyle()\n\n    setSrcToBackground: =>\n      @domImage.style.backgroundImage = \"url('#{@domImage.src}')\"\n      @domImage.style.backgroundRepeat = 'no-repeat'\n      @canvas.width = @domImage.naturalWidth\n      @canvas.height = @domImage.naturalHeight\n      @imgInfo.cachedDataUrl = @canvas.toDataURL()\n      @domImage.src = @imgInfo.cachedDataUrl\n\n    zoom: (deltaY, propagate = false) =>\n      zoomSensibility = if __whmodules.globals['isPinched']\n      then @options.zoom * @options.pinchSensibility\n      else @options.zoom\n\n      # zoom always at the center of the image\n      offsetX = @domImage.width / 2\n      offsetY = @domImage.height / 2\n\n      # Record the offset between the bg edge and the center of the image:\n      bgCenterX = offsetX - @imgInfo.bgPosX\n      bgCenterY = offsetY - @imgInfo.bgPosY\n\n      # Use the previous offset to get the percent offset between the bg edge\n      # and the center of the image:\n      bgRatioX = bgCenterX / @imgInfo.bgWidth\n      bgRatioY = bgCenterY / @imgInfo.bgHeight\n\n      # Update the bg size:\n      if deltaY < 0\n        if @options.maxZoom is -1 or\n        ((@imgInfo.bgWidth + @imgInfo.bgWidth * zoomSensibility) /\n        @imgInfo.width) <= @options.maxZoom\n          @imgInfo.bgWidth += @imgInfo.bgWidth * zoomSensibility\n          @imgInfo.bgHeight += @imgInfo.bgHeight * zoomSensibility\n      else\n        @imgInfo.bgWidth -= @imgInfo.bgWidth * zoomSensibility\n        @imgInfo.bgHeight -= @imgInfo.bgHeight * zoomSensibility\n\n      # Take the percent offset and apply it to the new size:\n      @imgInfo.bgPosX = offsetX - (@imgInfo.bgWidth * bgRatioX)\n      @imgInfo.bgPosY = offsetY - (@imgInfo.bgHeight * bgRatioY)\n\n      if propagate\n        if deltaY < 0 then @wzEvents.trigger 'wheelzoom.in', {\n          zoom: @imgInfo.bgWidth / @imgInfo.width,\n          bgPosX: @imgInfo.bgPosX,\n          bgPosY: @imgInfo.bgPosY\n        }\n        else @wzEvents.trigger 'wheelzoom.out', {\n          zoom: @imgInfo.bgWidth / @imgInfo.width,\n          bgPosX: @imgInfo.bgPosX,\n          bgPosY: @imgInfo.bgPosY\n        }\n\n      # Prevent zooming out beyond the starting size\n      if @imgInfo.bgWidth <= @imgInfo.width or @imgInfo.bgHeight <= @imgInfo.height\n        @wzEvents.trigger 'wheelzoom.reset'\n      else @updateBgStyle()\n\n    drag: (x, y) =>\n      @imgInfo.bgPosX = x\n      @imgInfo.bgPosY = y\n      @updateBgStyle()\n\n    destroy: =>\n      @domImage.style = @domImage.getAttribute('style')\n      @domImage.src = @domImage.getAttribute('src')\n      @wzImageApi.destroy()\n      delete @wzImageApi\n","__whmodules.addClass 'ImageApi',\n\n  class ImageApi\n\n    constructor: (_whzImage) ->\n      @whzImage = _whzImage\n      @domImage = _whzImage.domImage\n      @registerApiMethods()\n\n    registerApiMethods: =>\n      @domImage.doZoomIn = @doZoomIn.bind @\n      @domImage.doZoomOut = @doZoomOut.bind @\n      @domImage.doDrag = @doDrag.bind @\n\n    destroy: =>\n      delete @domImage.wz\n\n    doZoomIn: => @whzImage.zoom -100, false\n    doZoomOut: => @whzImage.zoom 100, false\n    doDrag: (x, y) => @whzImage.drag x, y\n","__whmodules.addClass 'Wheelzoom',\n\n  class Wheelzoom\n\n    # private static\n    wheelzoomSingleton = null\n    wzImgs = []\n    globals = __whmodules.globals\n\n    # public methods\n    constructor: (elements, options) ->\n      @init(elements, options)\n      if wheelzoomSingleton is not null then return wheelzoomSingleton\n      else return wheelzoomSingleton = @\n\n    init: (elements, options) ->\n      # Do nothing in IE8\n      if typeof window.getComputedStyle != 'function' then return elements\n      if elements and elements.length then addImage(element, options) for element in elements\n      else if (elements and elements.nodeName) then addImage(elements, options)\n      return elements\n\n    # private methods\n    addImage = (img, options) ->\n      if not img or not img.nodeName or img.nodeName != 'IMG' then return\n\n      wzImg = new Image img, parseOptions(options)\n      wzImgs.push wzImg\n\n    parseOptions = (options) ->\n      out = {}\n      options = options or {}\n      Object.keys(globals['defaults']).forEach (key) ->\n        out[key] = if typeof options[key] != 'undefined' then options[key]\n        else globals['defaults'][key]\n      return out\n\n    # public static methods\n    @images = -> wzImgs\n    @resetAll = -> wzImgs.forEach (wzImg) -> wzImg.reset()\n    @destroyAll = ->\n      while wzImgs.length\n        wzImgs[0].destroy()\n        wzImgs.splice(0, 1)\n","__whmodules.windowRegister ->\n  CustomEvent = (event, params) ->\n    params = params or { bubbles: false, cancelable: false, detail: undefined }\n    evt = document.createEvent 'CustomEvent'\n    evt.initCustomEvent event, params.bubbles, params.cancelable, params.detail\n    return evt\n\n  CustomEvent.prototype = window.Event.prototype\n  window.CustomEvent = CustomEvent\n","# create cross browser triggerEvent function\n__whmodules.windowRegister ->\n  window.triggerEvent = (target, eventName, params) ->\n    if params\n      e = new CustomEvent eventName, { detail: params }\n    else\n      try\n        e = new Event(eventName)\n      catch err\n        e = new CustomEvent(eventName)\n    return target.dispatchEvent(e, params)\n","(-> __whmodules.init())()\n"]}